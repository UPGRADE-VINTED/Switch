<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Commande Switch Multi-étapes</title>
<style>
  body { font-family: monospace, monospace; background: #f0f0f0; padding: 20px; }
  .step { display: none; background: #fff; padding: 15px; border-radius: 8px; margin-bottom: 20px; }
  .step.active { display: block; }
  .btn-group { margin-top: 10px; }
  button { padding: 8px 15px; margin-right: 10px; cursor: pointer; }
  .selected { border: 3px solid #4CAF50; }
  img { cursor: pointer; max-width: 100px; margin: 5px; border: 3px solid transparent; border-radius: 8px; }
  img.selected { border-color: #4CAF50; }
  .qty-control { display: inline-flex; align-items: center; margin: 0 10px; }
  .qty-control button { padding: 2px 8px; font-size: 18px; }
  .qty-control span { margin: 0 6px; min-width: 20px; text-align: center; display: inline-block; }
  #resumeCommande { white-space: pre-wrap; background: #222; color: #0f0; padding: 15px; border-radius: 6px; font-size: 14px; }
</style>
</head>
<body>

<h1>Commande Nintendo Switch - Étapes</h1>

<form id="formCommande">

  <!-- Étape 1 : Choix Switch -->
  <div class="step active" id="step1">
    <h2>Étape 1 : Choix de la console</h2>
    <div id="switches">
      <img src="https://i.imgur.com/nH8wl2v.png" alt="Switch OLED Blanche" data-id="oled_blanc" />
      <img src="https://i.imgur.com/3Z8RZp5.png" alt="Switch OLED Noir" data-id="oled_noir" />
      <img src="https://i.imgur.com/hVoqN0C.png" alt="Switch V2 Grise" data-id="v2_gris" />
    </div>
  </div>

  <!-- Étape 2 : Choix carte SD -->
  <div class="step" id="step2">
    <h2>Étape 2 : Choix carte SD</h2>
    <div id="carteSDs">
      <img src="https://i.imgur.com/lUtKu3I.png" alt="Carte SD 64Go" data-id="64go" />
      <img src="https://i.imgur.com/k64Uoy8.png" alt="Carte SD 128Go" data-id="128go" />
      <img src="https://i.imgur.com/9vd6pKZ.png" alt="Pas de carte SD" data-id="none" />
    </div>
  </div>

  <!-- Étape 3 : Joycon + quantités -->
  <div class="step" id="step3">
    <h2>Étape 3 : Choix des Joycon</h2>
    <div id="joycons">
      <div>
        <img src="https://i.imgur.com/OaTUrHp.png" alt="Joycon Bleu" data-id="jc_bleu" style="vertical-align: middle;" />
        <span>Bleu</span>
        <div class="qty-control">
          <button type="button" data-action="dec" data-id="jc_bleu">-</button>
          <span id="qty_jc_bleu">0</span>
          <button type="button" data-action="inc" data-id="jc_bleu">+</button>
        </div>
      </div>
      <div>
        <img src="https://i.imgur.com/y3wr8Q0.png" alt="Joycon Rouge" data-id="jc_rouge" style="vertical-align: middle;" />
        <span>Rouge</span>
        <div class="qty-control">
          <button type="button" data-action="dec" data-id="jc_rouge">-</button>
          <span id="qty_jc_rouge">0</span>
          <button type="button" data-action="inc" data-id="jc_rouge">+</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Étape 4 : Accessoires -->
  <div class="step" id="step4">
    <h2>Étape 4 : Choix des accessoires</h2>
    <label><input type="checkbox" name="accessoire" value="station_recharge" /> Station de recharge</label><br/>
    <label><input type="checkbox" name="accessoire" value="etui" /> Étui de protection</label><br/>
    <label><input type="checkbox" name="accessoire" value="protege_ecran" /> Protection écran</label>
  </div>

  <!-- Navigation -->
  <div class="btn-group">
    <button type="button" id="prevBtn" disabled>Précédent</button>
    <button type="button" id="nextBtn">Suivant</button>
  </div>

</form>

<h2>Résumé de la commande</h2>
<pre id="resumeCommande">(vide)</pre>

<script>
  const steps = document.querySelectorAll('.step');
  let currentStep = 0;

  const choix = {
    switch: null,
    carteSD: null,
    joycons: { jc_bleu: 0, jc_rouge: 0 },
    accessoires: new Set(),
  };

  const switches = {
    oled_blanc: { name: 'Switch OLED Blanche', price: 350 },
    oled_noir: { name: 'Switch OLED Noire', price: 350 },
    v2_gris: { name: 'Switch V2 Grise', price: 300 },
  };
  const carteSDs = {
    '64go': { name: 'Carte SD 64Go', price: 30 },
    '128go': { name: 'Carte SD 128Go', price: 50 },
    'none': { name: 'Sans carte SD', price: 0 },
  };
  const joyconsData = {
    jc_bleu: { name: 'Joycon Bleu', priceFirst: 35, priceNext: 30 },
    jc_rouge: { name: 'Joycon Rouge', priceFirst: 35, priceNext: 30 },
  };
  const accessoiresData = {
    station_recharge: { name: 'Station de recharge', price: 40 },
    etui: { name: 'Étui de protection', price: 25 },
    protege_ecran: { name: 'Protection écran', price: 15 },
  };

  // Gestion sélection Switch
  document.querySelectorAll('#switches img').forEach(img => {
    img.addEventListener('click', () => {
      document.querySelectorAll('#switches img').forEach(i => i.classList.remove('selected'));
      img.classList.add('selected');
      choix.switch = img.dataset.id;
      updateResume();
    });
  });

  // Gestion sélection carte SD
  document.querySelectorAll('#carteSDs img').forEach(img => {
    img.addEventListener('click', () => {
      document.querySelectorAll('#carteSDs img').forEach(i => i.classList.remove('selected'));
      img.classList.add('selected');
      choix.carteSD = img.dataset.id;
      updateResume();
    });
  });

  // Gestion quantités Joycon
  document.querySelectorAll('#joycons button').forEach(btn => {
    btn.addEventListener('click', () => {
      const id = btn.dataset.id;
      const action = btn.dataset.action;
      let qty = choix.joycons[id];
      if(action === 'inc') qty = Math.min(qty + 1, 10);
      else if(action === 'dec') qty = Math.max(qty -1, 0);
      choix.joycons[id] = qty;
      document.getElementById('qty_'+id).textContent = qty;
      updateResume();
    });
  });

  // Gestion accessoires checkbox
  document.querySelectorAll('input[name="accessoire"]').forEach(chk => {
    chk.addEventListener('change', () => {
      if(chk.checked) choix.accessoires.add(chk.value);
      else choix.accessoires.delete(chk.value);
      updateResume();
    });
  });

  // Navigation étapes
  const prevBtn = document.getElementById('prevBtn');
  const nextBtn = document.getElementById('nextBtn');

  prevBtn.addEventListener('click', () => {
    if(currentStep > 0){
      steps[currentStep].classList.remove('active');
      currentStep--;
      steps[currentStep].classList.add('active');
      updateButtons();
    }
  });

  nextBtn.addEventListener('click', () => {
    if(currentStep < steps.length -1){
      // Validation simple : ex. on doit avoir choisi Switch à l'étape 1, etc.
      if(currentStep === 0 && !choix.switch){
        alert('Veuillez choisir une console avant de continuer');
        return;
      }
      if(currentStep === 1 && !choix.carteSD){
        alert('Veuillez choisir une carte SD avant de continuer');
        return;
      }
      // on peut ajouter d'autres validations ici
      steps[currentStep].classList.remove('active');
      currentStep++;
      steps[currentStep].classList.add('active');
      updateButtons();
    } else {
      alert('Fin des étapes. Merci pour votre commande !');
    }
  });

  function updateButtons(){
    prevBtn.disabled = (currentStep === 0);
    nextBtn.textContent = (currentStep === steps.length - 1) ? 'Terminer' : 'Suivant';
  }

  // Résumé
  function updateResume(){
    let lines = [];
    if(choix.switch){
      const s = switches[choix.switch];
      lines.push(`Console : ${s.name} - ${s.price} €`);
    } else {
      lines.push('Console : (non choisie)');
    }
    if(choix.carteSD){
      const sd = carteSDs[choix.carteSD];
      lines.push(`Carte SD : ${sd.name} - ${sd.price} €`);
    } else {
      lines.push('Carte SD : (non choisie)');
    }
    lines.push('');
    lines.push('Joycon :');
    let totalJoy = 0;
    for(let jcId in choix.joycons){
      const qty = choix.joycons[jcId];
      if(qty > 0){
        const jc = joyconsData[jcId];
        let prixJC = qty === 1 ? jc.priceFirst : jc.priceFirst + (qty-1)*jc.priceNext;
        totalJoy += prixJC;
        lines.push(`  ${jc.name} x${qty} : ${prixJC} €`);
      }
    }
    if(totalJoy === 0) lines.push('  (aucun)');
    lines.push('');
    lines.push('Accessoires :');
    let totalAcc = 0;
    if(choix.accessoires.size === 0){
      lines.push('  (aucun)');
    } else {
      choix.accessoires.forEach(id => {
        const acc = accessoiresData[id];
        lines.push(`  ${acc.name} - ${acc.price} €`);
        totalAcc += acc.price;
      });
    }
    lines.push('');
    let total = 0;
    if(choix.switch) total += switches[choix.switch].price;
    if(choix.carteSD) total += carteSDs[choix.carteSD].price;
    total += totalJoy + totalAcc;
    lines.push('---------------------------');
    lines.push(`Total : ${total} €`);
    document.getElementById('resumeCommande').textContent = lines.join('\n');
  }

  updateResume();

</script>

</body>
</html>
