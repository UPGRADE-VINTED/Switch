<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Commande Switch - Étapes</title>
<style>
  body {
    font-family: monospace, monospace;
    max-width: 480px;
    margin: 20px auto;
    background: #f8f8f8;
    padding: 20px;
    border-radius: 8px;
  }
  h2 { margin-top: 0; }
  .step {
    display: none;
  }
  .step.active {
    display: block;
  }
  .images-choix img {
    width: 120px;
    margin: 5px;
    cursor: pointer;
    border: 2px solid transparent;
    border-radius: 5px;
    transition: border-color 0.3s;
  }
  .images-choix img.selected {
    border-color: #007bff;
  }
  .btns {
    margin-top: 20px;
  }
  button {
    padding: 8px 16px;
    margin-right: 10px;
    cursor: pointer;
    border-radius: 4px;
    border: none;
    background-color: #007bff;
    color: white;
    font-weight: bold;
  }
  button:disabled {
    background-color: #aaa;
    cursor: not-allowed;
  }
  /* Styles résumé */
  #resumeCommande {
    white-space: pre-wrap;
    background: #fff;
    border: 1px solid #ccc;
    padding: 15px;
    margin-top: 30px;
    border-radius: 5px;
  }
  .qty-control {
    display: inline-flex;
    align-items: center;
    margin: 5px 0;
  }
  .qty-control button {
    width: 25px; height: 25px;
    font-weight: bold;
    padding: 0;
    background: #007bff;
    color: white;
    border-radius: 3px;
    border: none;
    cursor: pointer;
  }
  .qty-control span {
    width: 25px;
    display: inline-block;
    text-align: center;
    margin: 0 8px;
  }
  label {
    cursor: pointer;
    user-select: none;
  }
  .checkbox-list {
    margin-top: 10px;
  }
  .checkbox-list label {
    display: block;
    margin-bottom: 6px;
  }
</style>
</head>
<body>

<h1>Commande Nintendo Switch - Étapes</h1>

<!-- Étape 1 : Choix Switch -->
<div class="step active" id="step1">
  <h2>1. Choisissez votre Switch</h2>
  <div class="images-choix" id="choixSwitchContainer">
    <img src="https://i.imgur.com/ZQXxS4L.png" alt="Switch OLED" data-id="oled" data-price="399" />
    <img src="https://i.imgur.com/2CqJXjW.png" alt="Switch Lite" data-id="lite" data-price="199" />
    <img src="https://i.imgur.com/wQWmPdw.png" alt="Switch Classique" data-id="classic" data-price="299" />
  </div>
  <div class="btns">
    <button id="step1Next" disabled>Suivant →</button>
  </div>
</div>

<!-- Étape 2 : Choix Carte SD -->
<div class="step" id="step2">
  <h2>2. Choisissez une carte SD (optionnel)</h2>
  <div class="images-choix" id="choixSDContainer">
    <img src="https://i.imgur.com/fFZQkuT.png" alt="Carte SD 64 Go" data-id="64go" data-price="40" />
    <img src="https://i.imgur.com/A1MvLY3.png" alt="Carte SD 128 Go" data-id="128go" data-price="70" />
    <img src="https://i.imgur.com/6bRnsG9.png" alt="Carte SD 256 Go" data-id="256go" data-price="120" />
  </div>
  <div class="btns">
    <button id="step2Prev">← Retour</button>
    <button id="step2Next">Suivant →</button>
  </div>
  <p><small>Vous pouvez ne rien sélectionner si vous ne voulez pas de carte SD.</small></p>
</div>

<!-- Étape 3 : Choix Joycon -->
<div class="step" id="step3">
  <h2>3. Choisissez vos Joycons</h2>
  <div id="joyconList">
    <div>
      <label>Standard Gris (35€ la 1ère, 30€ les suivantes): </label>
      <div class="qty-control">
        <button class="qty-minus" data-id="joycon-gris">−</button>
        <span id="qty-joycon-gris">0</span>
        <button class="qty-plus" data-id="joycon-gris">+</button>
      </div>
    </div>
    <div>
      <label>Couleur Rouge/Bleu (35€ la 1ère, 30€ les suivantes): </label>
      <div class="qty-control">
        <button class="qty-minus" data-id="joycon-rb">−</button>
        <span id="qty-joycon-rb">0</span>
        <button class="qty-plus" data-id="joycon-rb">+</button>
      </div>
    </div>
    <div>
      <label>Pro Controller (70€ la 1ère): </label>
      <div class="qty-control">
        <button class="qty-minus" data-id="pro-controller">−</button>
        <span id="qty-pro-controller">0</span>
        <button class="qty-plus" data-id="pro-controller">+</button>
      </div>
    </div>
  </div>
  <div class="btns">
    <button id="step3Prev">← Retour</button>
    <button id="step3Next">Suivant →</button>
  </div>
</div>

<!-- Étape 4 : Accessoires -->
<div class="step" id="step4">
  <h2>4. Choisissez vos accessoires</h2>
  <div class="checkbox-list" id="accessoiresList">
    <label><input type="checkbox" value="housse" data-price="20" /> Housse de protection (20 €)</label>
    <label><input type="checkbox" value="chargeur" data-price="15" /> Chargeur USB-C (15 €)</label>
    <label><input type="checkbox" value="station" data-price="40" /> Station de recharge (40 €)</label>
    <label><input type="checkbox" value="casque" data-price="50" /> Casque Bluetooth (50 €)</label>
  </div>
  <div class="btns">
    <button id="step4Prev">← Retour</button>
    <button id="step4Finish">Valider la commande</button>
  </div>
</div>

<!-- Résumé -->
<h2>Résumé de votre commande</h2>
<pre id="resumeCommande">(Votre sélection apparaîtra ici)</pre>

<script>
  // Variables stockage choix
  let choixSwitch = null; // {id, price, alt}
  let choixSD = null; // idem ou null
  let choixJoycon = { 'joycon-gris':0, 'joycon-rb':0, 'pro-controller':0 };
  let choixAccessoire = new Set();

  // --- Étape 1 : Choix Switch ---
  const step1Imgs = document.querySelectorAll('#choixSwitchContainer img');
  const step1NextBtn = document.getElementById('step1Next');

  step1Imgs.forEach(img => {
    img.addEventListener('click', () => {
      step1Imgs.forEach(i => i.classList.remove('selected'));
      img.classList.add('selected');
      choixSwitch = {
        id: img.dataset.id,
        price: Number(img.dataset.price),
        alt: img.alt
      };
      step1NextBtn.disabled = false;
      updateResume();
    });
  });

  step1NextBtn.addEventListener('click', () => {
    goToStep(2);
  });

  // --- Étape 2 : Choix SD ---
  const step2Imgs = document.querySelectorAll('#choixSDContainer img');
  const step2PrevBtn = document.getElementById('step2Prev');
  const step2NextBtn = document.getElementById('step2Next');

  step2Imgs.forEach(img => {
    img.addEventListener('click', () => {
      // toggle sélection
      if(img.classList.contains('selected')){
        img.classList.remove('selected');
        choixSD = null;
      } else {
        step2Imgs.forEach(i => i.classList.remove('selected'));
        img.classList.add('selected');
        choixSD = {
          id: img.dataset.id,
          price: Number(img.dataset.price),
          alt: img.alt
        };
      }
      updateResume();
    });
  });

  step2PrevBtn.addEventListener('click', () => goToStep(1));
  step2NextBtn.addEventListener('click', () => goToStep(3));

  // --- Étape 3 : Joycon quantités ---
  const joyconIds = Object.keys(choixJoycon);
  joyconIds.forEach(id => {
    document.querySelector(`#qty-${id}`).textContent = choixJoycon[id];
  });
  function updateQty(id, delta){
    let val = choixJoycon[id] + delta;
    if(val < 0) val = 0;
    if(val > 10) val = 10; // max 10 pour éviter débordement
    choixJoycon[id] = val;
    document.querySelector(`#qty-${id}`).textContent = val;
    updateResume();
  }
  document.querySelectorAll('.qty-plus').forEach(btn => {
    btn.addEventListener('click', () => {
      updateQty(btn.dataset.id, +1);
    });
  });
  document.querySelectorAll('.qty-minus').forEach(btn => {
    btn.addEventListener('click', () => {
      updateQty(btn.dataset.id, -1);
    });
  });

  document.getElementById('step3Prev').addEventListener('click', () => goToStep(2));
  document.getElementById('step3Next').addEventListener('click', () => goToStep(4));

  // --- Étape 4 : Accessoires checkbox ---
  const accCheckboxes = document.querySelectorAll('#accessoiresList input[type=checkbox]');
  accCheckboxes.forEach(cb => {
    cb.addEventListener('change', () => {
      if(cb.checked) choixAccessoire.add(cb.value);
      else choixAccessoire.delete(cb.value);
      updateResume();
    });
  });

  document.getElementById('step4Prev').addEventListener('click', () => goToStep(3));
  document.getElementById('step4Finish').addEventListener('click', () => {
    alert("Commande validée ! Voir le résumé ci-dessous.");
  });

  // --- Navigation entre étapes ---
  function goToStep(n){
    document.querySelectorAll('.step').forEach(div => div.classList.remove('active'));
    const stepDiv = document.getElementById('step' + n);
    if(stepDiv) stepDiv.classList.add('active');
  }

  // --- Mise à jour résumé ---
  function updateResume(){
    const lines = [];
    lines.push("Résumé de votre commande\n");
    if(choixSwitch){
      lines.push(`Switch: ${choixSwitch.alt} - ${choixSwitch.price} €`);
    } else {
      lines.push("Switch: (non sélectionnée)");
    }

    if(choixSD){
      lines.push(`Carte SD: ${choixSD.alt} - ${choixSD.price} €`);
    } else {
      lines.push("Carte SD: Aucune");
    }

    lines.push("\nJoycon:");
    // Prix joycon: 35€ la 1ère, 30€ les suivantes
    const joyconPrices = {
      'joycon-gris': {name:"Standard Gris", priceFirst:35, priceNext:30},
      'joycon-rb': {name:"Rouge/Bleu", priceFirst:35, priceNext:30},
      'pro-controller': {name:"Pro Controller", priceFirst:70, priceNext:0}
    };
    let totalJoycon = 0;
    joyconIds.forEach(id => {
      const qty = choixJoycon[id];
      if(qty > 0){
        const jp = joyconPrices[id];
        const prixJC = qty === 1 ? jp.priceFirst : jp.priceFirst + (qty-1)*jp.priceNext;
        lines.push(`  ${jp.name} x${qty} : ${prixJC} €`);
        totalJoycon += prixJC;
      }
    });
    if(totalJoycon === 0){
      lines.push("  Aucun");
    }

    lines.push("\nAccessoires:");
    let totalAcc = 0;
    const accData = {
      'housse': {name: "Housse de protection", price: 20},
      'chargeur': {name: "Chargeur USB-C", price: 15},
      'station': {name: "Station de recharge", price: 40},
      'casque': {name: "Casque Bluetooth", price: 50}
    };
    if(choixAccessoire.size === 0){
      lines.push("  Aucun");
    } else {
      choixAccessoire.forEach(accId => {
        const acc = accData[accId];
        if(acc){
          lines.push(`  ${acc.name} - ${acc.price} €`);
          totalAcc += acc.price;
        }
      });
    }

    // Total général
    let total = 0;
    if(choixSwitch) total += choixSwitch.price;
    if(choixSD) total += choixSD.price;
    total += totalJoycon + totalAcc;

    lines.push("\n-------------------------");
    lines.push(`Total : ${total} €`);

    document.getElementById('resumeCommande').textContent = lines.join('\n');
  }

</script>

</body>
</html>
