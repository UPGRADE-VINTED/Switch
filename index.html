<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Configurateur Switch</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 10px;
    background: #f7f7f7;
  }
  h2 {
    margin-bottom: 5px;
  }
  .step {
    margin-bottom: 20px;
  }
  .options {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
  }
  .option {
    border: 2px solid #ccc;
    border-radius: 8px;
    padding: 5px;
    cursor: pointer;
    text-align: center;
    width: 150px;
    background: white;
    transition: border-color 0.3s;
  }
  .option.selected {
    border-color: #28a745;
    box-shadow: 0 0 10px #28a745a0;
  }
  .option img {
    max-width: 150px;
    height: auto;
    margin-bottom: 5px;
    border-radius: 6px;
  }
  .option span {
    display: block;
    font-weight: bold;
  }
  .option small {
    font-weight: normal;
    font-size: 0.85em;
    color: #555;
  }
  button {
    background: #28a745;
    color: white;
    border: none;
    padding: 12px 25px;
    font-size: 1rem;
    border-radius: 6px;
    cursor: pointer;
  }
  button:disabled {
    background: #aaa;
    cursor: not-allowed;
  }
  #summary {
    background: white;
    padding: 15px;
    border-radius: 10px;
    font-family: 'Courier New', Courier, monospace;
    white-space: pre-wrap;
    box-shadow: 0 0 8px #ddd;
    max-width: 400px;
    margin-top: 20px;
  }
  @media(max-width: 480px) {
    .options {
      justify-content: center;
    }
    .option {
      width: 90vw;
    }
    .option img {
      max-width: 90vw;
    }
  }
</style>
</head>
<body>

<h1>Configure ta Switch</h1>

<div class="step" id="step1">
  <h2>1. Choisis ta Switch</h2>
  <div class="options" id="switch-options">
    <div class="option" data-name="Switch modèle V2 avec SD" data-price="190">
      <img src="https://i.imgur.com/XNzqOsB.jpeg" alt="Switch V2 avec SD"/>
      <span>Switch V2 avec SD</span>
      <small>(état impeccable)</small>
      <br>190 €
    </div>
    <div class="option" data-name="Switch modèle V2 OK" data-price="180">
      <img src="https://i.imgur.com/zKeTFqq.png" alt="Switch V2 OK"/>
      <span>Switch V2 OK</span>
      <small>(bon état)</small>
      <br>180 €
    </div>
    <div class="option" data-name="Switch modèle V1 rayure" data-price="140">
      <img src="https://i.imgur.com/p5yO1kM.png" alt="Switch V1 rayure"/>
      <span>Switch V1 rayure</span>
      <small>(manque SD + puce)</small>
      <br>140 €
    </div>
    <div class="option" data-name="Switch modèle V1 OK" data-price="150">
      <img src="https://i.imgur.com/p5yO1kM.png" alt="Switch V1 OK"/>
      <span>Switch V1 OK</span>
      <small>(bon état)</small>
      <br>150 €
    </div>
    <div class="option" data-name="Switch modèle V1 excellent" data-price="170">
      <img src="https://i.imgur.com/p5yO1kM.png" alt="Switch V1 excellent"/>
      <span>Switch V1 excellent</span>
      <small>(comme neuf)</small>
      <br>170 €
    </div>
  </div>
</div>

<div class="step" id="step2" style="display:none;">
  <h2>2. Choisis ta carte SD</h2>
  <div class="options" id="sd-options">
    <div class="option" data-name="Carte SD 128 Go" data-price="0">
      <img src="https://i.imgur.com/ZRiCDLr.jpeg" alt="SD 128 Go"/>
      <span>128 Go</span>
      <small>~10 jeux</small>
      <br>0 €
    </div>
    <div class="option" data-name="Carte SD 256 Go" data-price="30">
      <img src="https://i.imgur.com/ZRiCDLr.jpeg" alt="SD 256 Go"/>
      <span>256 Go</span>
      <small>~18 jeux</small>
      <br>30 €
    </div>
    <div class="option" data-name="Carte SD 512 Go" data-price="60">
      <img src="https://i.imgur.com/a3M2P8z.png" alt="SD 512 Go"/>
      <span>512 Go</span>
      <small>~35 jeux</small>
      <br>60 €
    </div>
  </div>
</div>

<div class="step" id="step3" style="display:none;">
  <h2>3. Choisis tes Joy-Con</h2>
  <div class="options" id="joycon-options">
    <div class="option" data-name="Joy-Con rouge/bleu" data-price="40">
      <img src="https://i.imgur.com/h4i6NT2.jpeg" alt="Joy-Con rouge/bleu"/>
      <span>Joy-Con rouge/bleu</span>
      <br>40 €
    </div>
    <div class="option" data-name="Joy-Con vert/rose" data-price="40">
      <img src="https://i.imgur.com/HnrlZdX.png" alt="Joy-Con vert/rose"/>
      <span>Joy-Con vert/rose</span>
      <br>40 €
    </div>
    <div class="option" data-name="Joy-Con gris" data-price="35">
      <img src="https://i.imgur.com/HnrlZdX.png" alt="Joy-Con gris"/>
      <span>Joy-Con gris</span>
      <br>35 €
    </div>
    <div class="option" data-name="Joy-Con jaune" data-price="38">
      <img src="https://i.imgur.com/1lwBpOt.jpeg" alt="Joy-Con jaune"/>
      <span>Joy-Con jaune</span>
      <br>38 €
    </div>
    <div class="option" data-name="Joy-Con violet" data-price="38">
      <img src="https://i.imgur.com/edqgNwl.jpeg" alt="Joy-Con violet"/>
      <span>Joy-Con violet</span>
      <br>38 €
    </div>
  </div>
</div>

<div class="step" id="step4" style="display:none;">
  <h2>4. Choisis tes accessoires</h2>
  <div class="options" id="accessory-options">
    <div class="option" data-name="Chargeur Hwfly" data-price="50">
      <img src="https://i.imgur.com/QylodKV.jpeg" alt="Chargeur Hwfly"/>
      <span>Chargeur Hwfly</span>
      <br>50 €
    </div>
    <div class="option" data-name="Câble HDMI" data-price="5">
      <img src="https://i.imgur.com/CYJdCjc.jpeg" alt="Câble HDMI"/>
      <span>Câble HDMI</span>
      <br>5 €
    </div>
    <div class="option" data-name="Chargeur Joy-Con" data-price="20">
      <img src="https://i.imgur.com/2a17uZp.jpeg" alt="Chargeur Joy-Con"/>
      <span>Chargeur Joy-Con</span>
      <br>20 €
    </div>
  </div>
</div>

<button id="next-btn" disabled>Suivant</button>

<div id="summary" style="display:none; white-space: pre-wrap; font-family: monospace;"></div>

<script>
  const steps = ['step1', 'step2', 'step3', 'step4'];
  let currentStep = 0;

  let selections = {
    switch: null,
    sd: null,
    joycon: null,
    accessory: []
  };

  const nextBtn = document.getElementById('next-btn');
  const summaryDiv = document.getElementById('summary');

  function updateButton() {
    let canContinue = false;
    if (currentStep === 3) {
      canContinue = true; // Accessories can be optional, so allow to proceed even if none selected
    } else {
      const stepId = steps[currentStep];
      const options = document.querySelectorAll(`#${stepId} .option.selected`);
      canContinue = options.length > 0;
    }
    nextBtn.disabled = !canContinue;
  }

  function clearSelections(stepId) {
    document.querySelectorAll(`#${stepId} .option.selected`).forEach(el => {
      el.classList.remove('selected');
    });
  }

  function selectOption(e) {
    const stepId = steps[currentStep];
    const option = e.currentTarget;
    if (stepId === 'step4') {
      // Accessories multiple select
      if (option.classList.contains('selected')) {
        option.classList.remove('selected');
        selections.accessory = selections.accessory.filter(a => a.name !== option.dataset.name);
      } else {
        option.classList.add('selected');
        selections.accessory.push({
          name: option.dataset.name,
          price: option.dataset.price
        });
      }
    } else {
      clearSelections(stepId);
      option.classList.add('selected');
      const data = {
        name: option.dataset.name,
        price: option.dataset.price
      };
      if (stepId === 'step1') selections.switch = data;
      if (stepId === 'step2') selections.sd = data;
      if (stepId === 'step3') selections.joycon = data;
    }
    updateButton();
  }

  function showStep(stepIndex) {
    steps.forEach((id, i) => {
      document.getElementById(id).style.display = i === stepIndex ? 'block' : 'none';
    });
    summaryDiv.style.display = 'none';
    if(stepIndex === steps.length - 1){
      nextBtn.textContent = 'Valider ma liste';
    } else {
      nextBtn.textContent = 'Suivant';
    }
    updateButton();
  }

  function formatPrice(price) {
    return parseFloat(price).toLocaleString('fr-FR', { style: 'currency', currency: 'EUR' });
  }

  function showSummary() {
    let total = 0;
    let lines = [];

    if (selections.switch) {
      total += parseFloat(selections.switch.price);
      lines.push(`- ${selections.switch.name.padEnd(25)} ${formatPrice(selections.switch.price)}`);
    }
    if (selections.joycon) {
      total += parseFloat(selections.joycon.price);
      lines.push(`- ${selections.joycon.name.padEnd(25)} ${formatPrice(selections.joycon.price)}`);
      lines.push(`    (${selections.joycon.name.includes('rouge/bleu') ? 'rouge/bleu' : ''})`);
    }
    if (selections.sd) {
      total += parseFloat(selections.sd.price);
      lines.push(`- ${selections.sd.name.padEnd(25)} ${formatPrice(selections.sd.price)}`);
    }
    if (selections.accessory.length > 0) {
      selections.accessory.forEach(acc => {
        total += parseFloat(acc.price);
        lines.push(`- ${acc.name.padEnd(25)} ${formatPrice(acc.price)}`);
      });
    }

    lines.push('');
    lines.push(`TOTAL${' '.repeat(20)}${formatPrice(total)}`);

    const ticket = lines.join('\n');
    summaryDiv.textContent = ticket;
    summaryDiv.style.display = 'block';
    nextBtn.disabled = true;
  }

  nextBtn.addEventListener('click', () => {
    if(currentStep < steps.length - 1){
      currentStep++;
      showStep(currentStep);
    } else {
      showSummary();
    }
  });

  // Attacher les événements sur les options
  steps.forEach(stepId => {
    document.querySelectorAll(`#${stepId} .option`).forEach(option => {
      option.addEventListener('click', selectOption);
    });
  });

  showStep(currentStep);
</script>

</body>
</html>
